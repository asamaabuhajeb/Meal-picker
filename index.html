<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Meal Picker — NEO</title>
  <meta name="color-scheme" content="dark">
  <style>
    :root{
      --bg:#0a0f1a; --text:#e9f0ff; --sub:#a7b3d8;
      --primary:#39ff14; --stroke:#1e2a44; --radius:16px;
      --glow:0 0 24px #39ff1480, 0 0 48px #39ff1426;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family: ui-sans-serif, -apple-system, Segoe UI, Inter, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 600px at 10% -10%, #12203b 0%, transparent 60%),
                  radial-gradient(1000px 800px at 110% 20%, #06112a 0%, transparent 60%),
                  var(--bg);
      color:var(--text);
    }
    .topbar{
      position:sticky; top:0; z-index:50; backdrop-filter: blur(10px);
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding:14px 20px; background:linear-gradient(180deg, #0a0f1acc 60%, transparent);
      border-bottom:1px solid #0c1428;
    }
    .brand{display:flex; align-items:center; gap:10px;}
    .brand .dot{width:10px; height:10px; border-radius:50%; background:var(--primary); box-shadow:var(--glow)}
    .brand h1{margin:0; font-size:clamp(18px,2.2vw,24px)}
    .brand em{font-style:normal; color:var(--primary)}
    .actions{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
    .btn{
      background:#0f1c34; color:#cfe1ff; border:1px solid #22345f; border-radius:12px;
      padding:10px 14px; font-weight:600; letter-spacing:.2px; cursor:pointer;
    }
    .btn.primary{background:linear-gradient(180deg,#0b2a18,#081f12); border-color:#255c3d; box-shadow:var(--glow); color:#d6ffe6}
    .btn.tiny{padding:8px 10px; font-size:12px}
    .total{
      padding:8px 12px; border:1px solid #214a2f; border-radius:999px; background:#0a1712;
      color:#cffff0; box-shadow:var(--glow); font-weight:700; white-space:nowrap;
    }

    .container{
      width:min(1200px, 92vw); margin:18px auto 40px;
      display:grid; grid-template-columns:1fr; gap:18px;
    }
    @media (min-width:700px){ .container{ grid-template-columns:1fr 1fr; } }
    @media (min-width:1040px){ .container{ grid-template-columns:1fr 1fr 1fr; } }

    .card{
      background:linear-gradient(180deg, #0c1428aa, #0b1222aa);
      border:1px solid var(--stroke); border-radius:var(--radius); overflow:hidden;
      transition:transform .25s ease, border-color .25s ease;
    }
    .card:hover{ transform:translateY(-2px); border-color:#2a3d6b; }
    .card__head{ padding:18px 18px 8px 18px; }
    .badge{display:inline-block; padding:6px 10px; border:1px solid #142040; border-radius:999px; background:#071121; color:#9ec2ff; font-size:12px; letter-spacing:.3px}
    .title{ margin:8px 0; font-size:clamp(18px,2vw,22px) }
    .meta{ display:flex; gap:10px; flex-wrap:wrap; color:var(--sub); font-size:13px; }

    .ingredients, .steps{ padding:6px 18px 14px 18px; }
    .ingredients h3, .steps h3{ margin:10px 0; font-size:14px; color:#cfe1ff; letter-spacing:.3px; }
    .ingList{ list-style:none; margin:0; padding:0; display:grid; grid-template-columns:1fr; gap:10px; }
    @media (min-width:540px){ .ingList{ grid-template-columns:1fr 1fr; } }
    .ingItem{ display:flex; gap:10px; align-items:center; background:#0a1327; border:1px solid #142040; border-radius:12px; padding:8px; }
    .ingIcon{ width:48px; height:48px; border-radius:10px; border:1px solid #213462; overflow:hidden; }
    .ingIcon svg{ width:48px; height:48px; display:block; }
    .stepList{ margin:0; padding-left:20px; color:#dbe6ff; }
    .stepList li{ margin-bottom:8px; line-height:1.4; }
    .card__actions{ display:flex; gap:10px; padding:14px 18px 18px; flex-wrap:wrap; }

    .foot{
      width:min(1200px,92vw); margin:20px auto 60px; color:var(--sub);
      display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap;
    }
  </style>
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <span class="dot"></span>
      <h1>Meal Picker <em>NEO</em></h1>
    </div>
    <nav class="actions">
      <button id="generateAll" class="btn primary">Generate Day</button>
      <button id="shuffleAll" class="btn">Shuffle</button>
      <button id="copyAll" class="btn">Copy</button>
      <span id="totalCals" class="total">Total: 0 kcal</span>
    </nav>
  </header>

  <main class="container" id="app" tabindex="-1"></main>

  <footer class="foot">
    <div>Single-file • SVG icons (no external images) • Zero dependencies</div>
    <label class="toggle">
      <input type="checkbox" id="reduceMotion">
      <span>Reduce motion</span>
    </label>
  </footer>

  <template id="mealCardTpl">
    <section class="card">
      <div class="card__head">
        <div class="badge">Meal</div>
        <h2 class="title"></h2>
        <div class="meta">
          <span class="calories"></span>
          <span class="time"></span>
          <span class="tags"></span>
        </div>
      </div>
      <div class="ingredients">
        <h3>Ingredients</h3>
        <ul class="ingList"></ul>
      </div>
      <div class="steps">
        <h3>Steps</h3>
        <ol class="stepList"></ol>
      </div>
      <div class="card__actions">
        <button class="btn tiny" data-action="regenerate">Regenerate</button>
        <button class="btn tiny" data-action="swap">Swap</button>
        <button class="btn tiny" data-action="copy">Copy</button>
      </div>
    </section>
  </template>

  <script>
    // -------- Data --------
    const MEAL_DATA = {
      breakfast: [
        {name:"Zaatar & Labneh Wrap",calories:420,time:"10 min",tags:["Vegetarian","Quick"],
         ingredients:["flatbread","labneh","zaatar","olive oil","cucumber","tomato","mint"],
         steps:["Spread labneh on warm flatbread.","Sprinkle zaatar and drizzle olive oil.","Add sliced cucumber, tomato, and mint; roll tightly."]},
        {name:"Egg & Halloumi Plate",calories:480,time:"12 min",tags:["High-Protein"],
         ingredients:["eggs","halloumi","olives","cherry tomatoes","olive oil"],
         steps:["Pan-sear halloumi until golden.","Fry or scramble eggs.","Plate with olives and tomatoes, drizzle olive oil."]}
      ],
      lunch: [
        {name:"Chicken Shawarma Bowl",calories:650,time:"25 min",tags:["Protein","Meal-prep"],
         ingredients:["chicken breast","shawarma spice","rice","cabbage","garlic sauce","pickles"],
         steps:["Season chicken with shawarma spice and pan-sear.","Serve over rice with shredded cabbage and pickles.","Drizzle with garlic sauce."]},
        {name:"Tuna Pasta Salad",calories:560,time:"20 min",tags:["Cold","Quick"],
         ingredients:["pasta","tuna","sweet corn","olive oil","lemon","parsley"],
         steps:["Boil pasta; drain and cool.","Mix with tuna, corn, chopped parsley.","Dress with olive oil and lemon."]}
      ],
      dinner: [
        {name:"Grilled Kofta with Bulgur",calories:700,time:"30 min",tags:["Balanced"],
         ingredients:["kofta","bulgur","onion","tomato","yogurt","parsley"],
         steps:["Grill kofta until cooked through.","Simmer bulgur with salt until fluffy.","Serve with chopped tomato, onion, parsley, and yogurt."]},
        {name:"Salmon & Veg Traybake",calories:590,time:"25 min",tags:["Omega-3","One-pan"],
         ingredients:["salmon","potatoes","broccoli","olive oil","lemon","garlic"],
         steps:["Roast potato cubes 10 min.","Add salmon and broccoli; drizzle oil, lemon, garlic; roast 12-15 min."]}
      ],
      snack: [
        {name:"Dates & Peanut Butter",calories:260,time:"2 min",tags:["Quick","Sweet"],
         ingredients:["medjool dates","peanut butter","walnuts"],
         steps:["Pit dates, fill with peanut butter, top with walnut pieces."]},
        {name:"Greek Yogurt Cup",calories:280,time:"3 min",tags:["Protein"],
         ingredients:["greek yogurt","honey","banana","oats"],
         steps:["Layer yogurt with sliced banana, drizzle honey, sprinkle oats."]}
      ]
    };

    const TYPES = ["breakfast","lunch","dinner","snack"];
    const STATE = { meals:{} };

    // -------- Helpers --------
    const qs = (s,el=document)=>el.querySelector(s);
    function pickRandom(a){return a[Math.floor(Math.random()*a.length)];}
    function makeMeal(type){const v=pickRandom(MEAL_DATA[type]);return {...v,type};}

    // Robust inline SVG label icon (works everywhere)
    function svgLabelIcon(text){
      const t = (text||'').toUpperCase().replace(/[^A-Z0-9]/g,' ').trim().split(/\s+/).slice(0,2).map(s=>s[0]).join('') || 'FO';
      const colors = ['#0c1933','#0e1f42','#0b1730']; // subtle random bg shades
      const bg = colors[(t.charCodeAt(0)+t.length)%colors.length];
      const svg = `
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 96 96">
          <defs>
            <linearGradient id="g" x1="0" x2="1" y1="0" y2="1">
              <stop offset="0" stop-color="${bg}"/>
              <stop offset="1" stop-color="#081226"/>
            </linearGradient>
          </defs>
          <rect rx="12" ry="12" x="1" y="1" width="94" height="94" fill="url(#g)" stroke="#213462"/>
          <text x="50" y="58" text-anchor="middle" font-family="ui-sans-serif, -apple-system, Segoe UI, Inter, Roboto" font-size="40" fill="#dbe6ff">${t}</text>
        </svg>`;
      const wrap = document.createElement('div');
      wrap.className = 'ingIcon';
      wrap.innerHTML = svg.trim();
      return wrap;
    }

    function computeTotal(){
      return TYPES.reduce((sum,t)=> sum + (STATE.meals[t]?.calories||0), 0);
    }
    function updateTotal(){
      qs('#totalCals').textContent = `Total: ${computeTotal()} kcal`;
    }

    function renderAll(){
      const app = qs('#app'); app.innerHTML = "";
      TYPES.forEach(t=>{ STATE.meals[t] = STATE.meals[t] || makeMeal(t); app.appendChild(renderCard(STATE.meals[t])); });
      updateTotal();
    }

    function renderCard(meal){
      const tpl = qs('#mealCardTpl').content.cloneNode(true);
      const card = tpl.querySelector('.card');

      tpl.querySelector('.badge').textContent = meal.type.toUpperCase();
      tpl.querySelector('.title').textContent = meal.name;
      tpl.querySelector('.calories').textContent = `${meal.calories} kcal`;
      tpl.querySelector('.time').textContent = `⏱ ${meal.time}`;
      tpl.querySelector('.tags').textContent = meal.tags.join(" • ");

      const ingList = tpl.querySelector('.ingList');
      meal.ingredients.forEach(ing=>{
        const li = document.createElement('li'); li.className='ingItem';
        const icon = svgLabelIcon(ing);
        const label = document.createElement('span'); label.textContent = ing;
        li.append(icon, label);
        ingList.appendChild(li);
      });

      const stepList = tpl.querySelector('.stepList');
      meal.steps.forEach(s=>{ const li=document.createElement('li'); li.textContent=s; stepList.appendChild(li); });

      // actions
      tpl.querySelector('[data-action="regenerate"]').onclick = ()=>{
        STATE.meals[meal.type] = makeMeal(meal.type);
        replaceCard(card, STATE.meals[meal.type]);
        updateTotal();
      };
      tpl.querySelector('[data-action="swap"]').onclick = ()=>{
        const other = pickRandom(TYPES.filter(t=>t!==meal.type));
        const newMeal = makeMeal(other);
        STATE.meals[other] = newMeal;
        replaceCard(card, newMeal);
        updateTotal();
      };
      tpl.querySelector('[data-action="copy"]').onclick = ()=>{
        navigator.clipboard.writeText(stringifyMeal(meal)).then(()=>toast("Copied!"));
      };

      return tpl;
    }

    function replaceCard(oldCard, newMeal){
      oldCard.parentElement.replaceChild(renderCard(newMeal), oldCard);
    }

    function stringifyMeal(m){
      return `${m.type.toUpperCase()}: ${m.name}
Calories: ${m.calories} • Time: ${m.time} • ${m.tags.join(", ")}

Ingredients:
- ${m.ingredients.join("\n- ")}

Steps:
${m.steps.map((s,i)=>`${i+1}. ${s}`).join("\n")}`;
    }

    // tiny toast
    let toastEl;
    function toast(msg){
      if(!toastEl){
        toastEl = document.createElement('div');
        Object.assign(toastEl.style,{position:'fixed',bottom:'22px',left:'50%',transform:'translateX(-50%)',background:'#0b1325',color:'#dff6ff',border:'1px solid #25527a',padding:'10px 14px',borderRadius:'10px',boxShadow:'0 8px 30px rgba(0,0,0,.35)',zIndex:'9999'});
        document.body.appendChild(toastEl);
      }
      toastEl.textContent = msg; toastEl.style.opacity='1'; setTimeout(()=>toastEl.style.opacity='0',1200);
    }

    // top controls
    qs('#generateAll').onclick = ()=>{ TYPES.forEach(t=> STATE.meals[t] = makeMeal(t)); renderAll(); };
    qs('#shuffleAll').onclick  = ()=>{ TYPES.forEach(t=> STATE.meals[t] = makeMeal(t)); renderAll(); };
    qs('#copyAll').onclick     = ()=>{ navigator.clipboard.writeText(TYPES.map(t=> stringifyMeal(STATE.meals[t])).join("\n\n---\n\n")).then(()=>toast("All meals copied!")); };

    // boot
    window.addEventListener('DOMContentLoaded', ()=>{
      TYPES.forEach(t=> STATE.meals[t] = makeMeal(t));
      renderAll();
    });
  </script>
</body>
</html>